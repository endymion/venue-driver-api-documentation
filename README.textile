h1. Venue Driver API Documentation

h2. REST API

Venue Driver provides a simple HTTP API that's built according to a REST design pattern.  That just means that each of our resources like "Events" has a URL that you can call, and each resource has 'index', 'create', 'read', 'update' and 'delete' actions.  You tell it whether you want your data in XML or JSON.  In some cases we also provide HTML representations so that you don't even have to process raw data.

h3. Resources

Venue Driver provides easy XML or JSON access to Reservation and Guest (for Guestlist) resources:

* Venues/Events
* Reservations
* Guests
* Contacts

h2. Common tasks

h3. Get an event list

You can get an event list for a venue record in Venue Driver if you have a valid login and also the venue ID.  The API's /venues resource exposes a nested events resource.  So if you want the events for the venue with ID 1234, then you can get that with:

<pre>
<code>
curl 'http://venuedriver.com/api/venues/129582/events.xml?username=venuesite&password=password'
</code>
</pre>
  
The above will return something like this:

<pre>
<code>
<events type="array">
  <event>
    <VIP-URL nil="true"></VIP-URL>
    <active type="boolean" nil="true"></active>
    <ages nil="true"></ages>
    <close type="datetime">2000-01-01T08:15:00-05:00</close>
    <closed-message nil="true"></closed-message>
    <cover nil="true"></cover>
    <created-at type="datetime">2010-02-09T20:48:10-05:00</created-at>
    <date type="date">2010-03-12</date>
    <description nil="true"></description>
    <guestlist-URL nil="true"></guestlist-URL>
    <guestlist-conditions nil="true"></guestlist-conditions>
    <home-URL nil="true"></home-URL>
    <id type="integer">5635</id>
    <myspace-URL nil="true"></myspace-URL>
    <open type="datetime">2000-01-01T22:30:00-05:00</open>
    <tickets-URL nil="true"></tickets-URL>
    <tickets-sold-count type="integer">0</tickets-sold-count>
    <time type="datetime" nil="true"></time>
    <title>Friday Event</title>
    <updated-at type="datetime">2010-03-01T14:42:29-05:00</updated-at>
  </event>
  <event>
    <VIP-URL nil="true"></VIP-URL>
    <active type="boolean" nil="true"></active>
    <ages nil="true"></ages>
    <close type="datetime">2000-01-01T08:15:00-05:00</close>
    <closed-message nil="true"></closed-message>
    <cover nil="true"></cover>
    <created-at type="datetime">2010-02-09T20:48:35-05:00</created-at>
    <date type="date">2010-03-13</date>
    <description nil="true"></description>
    <guestlist-URL nil="true"></guestlist-URL>
    <guestlist-conditions nil="true"></guestlist-conditions>
    <home-URL nil="true"></home-URL>
    <id type="integer">5636</id>
    <myspace-URL nil="true"></myspace-URL>
    <open type="datetime">2000-01-01T22:00:00-05:00</open>
    <tickets-URL nil="true"></tickets-URL>
    <tickets-sold-count type="integer">0</tickets-sold-count>
    <time type="datetime" nil="true"></time>
    <title>Saturday Event</title>
    <updated-at type="datetime">2010-03-01T14:42:29-05:00</updated-at>
  </event>
</events>
</code>
</pre>

h2. Convenience methods

Venue Driver provides an API method that will return HTML code for an event select box, to be inserted
directly into a web page.  For example, to get a drop-down select box for all upcoming events at the venue with Venue Driver ID code 129582, you might call a URL like this:

  <pre><code>
	http://venuedriver.com/api/venues/129582/events/select_tag.html?username=venuesite&password=password
  </code></pre>

You can test from the command line using the cURL utility:

  <pre><code>
  curl 'http://venuedriver.com/api/venues/129582/events/select_tag.html?username=venuesite&password=password'
  </code></pre>

It will return something like this:

  <pre><code>
  <select id="event" name="event"><option value="3768">Cabaret of Dr. Calagari - Apr 16</option>
  <option value="3769">Latin Night and Tequila Party - Apr 17</option>
  <option value="3859">Visionshock - International District Spring Roll Party - Apr 24</option>
  <option value="3860">Sounders Latin Preparty - Apr 25</option>
  <option value="3832">Glamour - May 01</option></select>
  </code></pre>

Using that resource URL is pretty simple.  In Ruby for example it looks like this:

  <pre><code>
	url = "http://venuedriver/api/venues/129582/events/select_tag.html?username=venuesite&password=password"
	events_html = Net::HTTP.get_response(URI.parse(url))
  </code></pre>

Then you can just drop that HTML snippet into your form with @<%= events_html %>@ or the equivalent in PHP or whatever.  That gives you a simple way to build a form that can request guest list signup for any upcoming event.

When somebody submits the form, creating the guest list entry is similarly simple.  It also involves a simple HTTP query to an API URL.  Are you using PHP?  I can send you an example snippet for doing the post if so.

h2. Examples

h3. Ruby on Rails

"Promoter":http://github.com/angelmg/promoter is a Rails plugin for accessing the Venue Driver API.  Promoter is a Rails Engine plugin that adds controllers and views to your web site for providing reservation, guest list and mailing list signup forms.  It uses Active Resource to access Venue Driver.

h3. PHP

These examples show how to build reservation and guest list forms with PHP.  These examples use a "PHP library":http://code.google.com/p/phpactiveresource/ for accessing our REST resources.

Here are the example files:

"Example PHP reservation form":http://github.com/endymion/venue-driver-api-documentation/raw/master/examples/php/ReservationForm.php
"Example PHP guest list form":http://github.com/endymion/venue-driver-api-documentation/raw/master/examples/php/GuestListForm.php
"Venue Driver API configuration file":http://github.com/endymion/venue-driver-api-documentation/raw/master/examples/php/VenueDriver.php
"ActiveResource REST API for PHP":http://github.com/endymion/venue-driver-api-documentation/raw/master/examples/php/ActiveResource.php